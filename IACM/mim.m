function rt = mim(I,sa)

S=size(I);
s1=S(1);
M=s1;
s2=S(2);
N=s2;
NF=24*2; 
F=zeros(25,24,NF);
f2 = -1*[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;     %1
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;       %5
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;       %10
     0 0 0 0 0 0 4 3 2 1 0 -10 -10 0 1 2 3 4 0 0 0 0 0 0;   %added
     0 0 0 0 0 0 4 3 2 1 0 -10 -10 0 1 2 3 4 0 0 0 0 0 0;   %added
     0 0 0 0 0 0 4 3 2 1 0 -10 -10 0 1 2 3 4 0 0 0 0 0 0; 
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;       %15
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;       %20
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]; 
 
F(:,:,1)=f2;
 for i=1:NF-1
     F(:,:,i+1)=imrotate(F(:,:,1),(180/NF)*i,'bilinear','crop');
 end
 for i=1:NF
     Filtered_image(:,:,i)=(conv2(I,F(:,:,i),'same'));
 end

Filtered_image_Reshaped=zeros(NF,s1*s2);
A1=zeros(1,s1*s2);
 for i=1:NF
     Filtered_image_Reshaped(i,:)=reshape(Filtered_image(:,:,i),1,s1*s2);
 end

  A1=max(Filtered_image_Reshaped);
  Response_image=reshape(A1,s1,s2);
  rt=Response_image;
rmin = abs(min(min(rt(:))));
for m = 1:M
    for n = 1:N
        rt(m,n) = rt(m,n) + rmin;
    end
end
rmax = max(max(rt));
for m = 1:M
    for n = 1:N
        rt(m,n) = round(rt(m,n)*255/rmax);
    end
end
